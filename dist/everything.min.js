var gameLogic;!function(a){function b(){return[["","","","","","","","","","","","","","","","","","","",""],["","","","","","","","","","","","","","","","","","","",""],["","","","","","","","","","","","","","","","","","","",""],["","","","","","","","","","","","","","","","","","","",""],["","","","","","","","","","","","","","","","","","","",""],["","","","","","","","","","","","","","","","","","","",""],["","","","","","","","","","","","","","","","","","","",""],["","","","","","","","","","","","","","","","","","","",""],["","","","","","","","","","","","","","","","","","","",""],["","","","","","","","","","","","","","","","","","","",""],["","","","","","","","","","","","","","","","","","","",""],["","","","","","","","","","","","","","","","","","","",""],["","","","","","","","","","","","","","","","","","","",""],["","","","","","","","","","","","","","","","","","","",""],["","","","","","","","","","","","","","","","","","","",""],["","","","","","","","","","","","","","","","","","","",""],["","","","","","","","","","","","","","","","","","","",""],["","","","","","","","","","","","","","","","","","","",""],["","","","","","","","","","","","","","","","","","","",""],["","","","","","","","","","","","","","","","","","","",""]]}function c(){return[[!0,!0,!0,!0,!0,!0,!0,!0,!0,!0,!0,!0,!0,!0,!0,!0,!0,!0,!0,!0,!0],[!0,!0,!0,!0,!0,!0,!0,!0,!0,!0,!0,!0,!0,!0,!0,!0,!0,!0,!0,!0,!0],[!0,!0,!0,!0,!0,!0,!0,!0,!0,!0,!0,!0,!0,!0,!0,!0,!0,!0,!0,!0,!0],[!0,!0,!0,!0,!0,!0,!0,!0,!0,!0,!0,!0,!0,!0,!0,!0,!0,!0,!0,!0,!0]]}function d(){return[!0,!0,!0,!0]}function e(a,b){var c=h(a,b,5);return c.length>0?c:(c=h(a,b,4),c.length>0?c:h(a,b,3))}function f(){for(var a,b,c=[],d=1,e=9;e>=0;e--){for(a=e,b=e;e+d>b;b++)c.push([a,b]);for(;e+d>a;a++)c.push([a,b]);for(;b>e;b--)c.push([a,b]);for(;a>e;a--)c.push([a,b]);d+=2}return c}function g(a){for(var b=a.length,c=0;b>c;c++){var d=c+Math.floor(Math.random()*(b-c)),e=a[d];a[d]=a[c],a[c]=e}return a}function h(a,b,c){var d=[],e=[],h=a.freeShapes,i=a.board,l=0;d=g(5===c?[4,9,10,11,12,13,15,16,17,18,19,20]:4===c?[3,6,7,8,14]:[0,1,2,5]);for(var m=f(),n=0;n<m.length&&1>l;n++){var o=m[n][0],p=m[n][1];if(""===i[o][p]&&!w(i,o,p,b))for(var q=0;q<d.length&&1>l;q++){var r=d[q];if(h[b][r])for(var s=g(j(r)),t=0;t<s.length&&1>l;t++){var u=C(o,p,r,t);B(i,u,b)&&1>l&&(e.push(k(a,u,r,b)),l++)}}}return e}function i(a,b){return 0===a||8===a||19===a?0===b:1===a||2===a||3===a||4===a?0===b||1===b:5===a||10===a||11===a||14===a||16===a||17===a?0===b||1===b||2===b||3===b:7===a||13===a?0===b||1===b||4===b||5===b:6===a||9===a||12===a||15===a||18===a||20===a?!0:!1}function j(a){var b=[];return(0===a||8===a||19===a)&&b.push(0),(1===a||2===a||3===a||4===a)&&b.push(0,1),(5===a||10===a||11===a||14===a||16===a||17===a)&&b.push(0,1,2,3),(7===a||13===a)&&b.push(0,1,4,5),(6===a||9===a||12===a||15===a||18===a||20===a)&&b.push(0,1,2,3,4,5,6,7),b}function k(a,e,f,g){var h=g;(void 0===a||void 0===a.board)&&(a={board:b(),playerStatus:d(),freeShapes:c(),delta:{}});var i=a.board,j=a.playerStatus,k=a.freeShapes;if(!B(i,e,g))throw new Error("illegal placement of a shape!");if(r(j))throw new Error("Can only make a move if the game is not over!");for(var l=angular.copy(i),n=g.toString(),p=0;p<e.length;p++){var s=e[p][0],t=e[p][1];l[s][t]=n}var u=m(g,k,f),v=o(l,u,j),w=q(g,v,u);return[w,{set:{key:"board",value:l}},{set:{key:"playerStatus",value:v}},{set:{key:"freeShapes",value:u}},{set:{key:"delta",value:{shape:f,placement:e}}},{set:{key:"internalTurnIndex",value:D()}},{set:{key:"lastIndex",value:h}}]}function l(a){var b=a.move;console.log(a);var c=a.stateBeforeMove,d=b[6].set.value;try{var e=b[4].set.value.shape,f=b[4].set.value.placement,g=k(c,f,e,d);if(g[6].set.value=d,console.log("expected move: "),console.log(g),!angular.equals(b,g))return!1}catch(h){return!1}return!0}function m(a,b,c){var d=angular.copy(b);if(0==d[a][c])throw new Error("the shape is already used by the player!");return d[a][c]=!1,d}function n(a,b,c){if(A(a,c))return!0;for(var d=0;20>d;d++)for(var e=0;20>e;e++)if(""===a[d][e]&&!w(a,d,e,c))for(var f=0;21>f;f++)if(b[c][f])for(var g=0;8>g;g++)if(i(f,g)){var h=C(d,e,f,g);if(z(a,h)&&!y(a,h)&&!x(a,h,c)&&v(a,h,c))return!0}return!1}function o(a,b,c){for(var d=angular.copy(c),e=0;4>e;e++)p(e,b)&&(d[e]=!1);for(var e=0;4>e;e++)d[e]&&(d[e]=n(a,b,e));return d}function p(a,b){for(var c=0;21>c;c++)if(b[a][c])return!1;return!0}function q(a,b,c){var d={};if(r(b))d={endMatch:{endMatchScores:s(c)}};else{for(E=(a+1)%4;b[E]===!1;)E=(E+1)%4;d={setTurn:{turnIndex:Math.floor(E/2)}}}return d}function r(a){for(var b=0;b<a.length;b++)if(a[b])return!1;return!0}function s(a){for(var b=[0,0,0,0],c=0;4>c;c++){for(var d=0;21>d;d++)a[c][d]||(0===d&&(b[c]+=1),1===d&&(b[c]+=2),(2===d||5===d)&&(b[c]+=3),(3===d||6===d||7===d||8===d||14===d)&&(b[c]+=4),(4===d||9===d||10===d||11===d||12===d||13===d||15===d||16===d||18===d||19===d||20===d)&&(b[c]+=5));p(c,a)&&(b[c]+=20),console.log(b)}return[b[0]+b[1],b[2]+b[3]]}function t(a,b,c){return b>=0&&b<a.length&&c>=0&&c<a[0].length}function u(a,b,c,d){var e=d.toString();return t(a,b+1,c+1)&&a[b+1][c+1]===e||t(a,b+1,c-1)&&a[b+1][c-1]===e||t(a,b-1,c+1)&&a[b-1][c+1]===e||t(a,b-1,c-1)&&a[b-1][c-1]===e?!0:!1}function v(a,b,c){for(var d=0;d<b.length;d++){var e=(c.toString(),b[d][0]),f=b[d][1];if(u(a,e,f,c))return!0}return!1}function w(a,b,c,d){var e=d.toString();return t(a,b+1,c)&&a[b+1][c]===e||t(a,b-1,c)&&a[b-1][c]===e||t(a,b,c+1)&&a[b][c+1]===e||t(a,b,c-1)&&a[b][c-1]===e?!0:!1}function x(a,b,c){for(var d=0;d<b.length;d++){var e=(c.toString(),b[d][0]),f=b[d][1];if(w(a,e,f,c))return!0}return!1}function y(a,b){var c;for(c=0;c<b.length;c++){var d=b[c][0],e=b[c][1];if(""!==a[d][e])return!0}return!1}function z(a,b){for(var c=0;c<b.length;c++){var d=b[c][0],e=b[c][1];if(!t(a,d,e))return!1}return!0}function A(a,b){var c=b.toString();return a[0][0]===c||a[0][19]===c||a[19][0]===c||a[19][19]===c?!1:!0}function B(a,b,c){if(A(a,c)){for(var d=0;d<b.length;d++)if(angular.equals(b[d],[0,0])||angular.equals(b[d],[0,19])||angular.equals(b[d],[19,0])||angular.equals(b[d],[19,19]))return z(a,b)&&!y(a,b);return!1}return z(a,b)&&!y(a,b)&&!x(a,b,c)&&v(a,b,c)}function C(a,b,c,d){var e=[];switch(c){case 0:e.push([a,b]);break;case 1:0===d&&e.push([a,b],[a-1,b]),1===d&&e.push([a,b-1],[a,b]);break;case 2:0===d&&e.push([a,b],[a-1,b],[a-2,b]),1===d&&e.push([a,b-2],[a,b-1],[a,b]);break;case 3:0===d&&e.push([a,b],[a-1,b],[a-2,b],[a-3,b]),1===d&&e.push([a,b-3],[a,b-2],[a,b-1],[a,b]);break;case 4:0===d&&e.push([a,b],[a-1,b],[a-2,b],[a-3,b],[a-4,b]),1===d&&e.push([a,b-4],[a,b-3],[a,b-2],[a,b-1],[a,b]);break;case 5:0===d&&e.push([a,b],[a,b-1],[a-1,b-1]),1===d&&e.push([a,b],[a,b-1],[a+1,b-1]),2===d&&e.push([a,b],[a-1,b],[a-1,b-1]),3===d&&e.push([a,b],[a-1,b],[a,b-1]);break;case 6:0===d&&e.push([a,b],[a,b-1],[a-1,b-1],[a-2,b-1]),1===d&&e.push([a,b],[a,b-1],[a,b-2],[a+1,b-2]),2===d&&e.push([a,b],[a-1,b],[a-2,b],[a-2,b-1]),3===d&&e.push([a,b],[a,b-1],[a,b-2],[a-1,b]),4===d&&e.push([a,b],[a-1,b],[a-2,b],[a,b-1]),5===d&&e.push([a,b],[a,b-1],[a,b-2],[a-1,b-2]),6===d&&e.push([a,b],[a,b-1],[a+1,b-1],[a+2,b-1]),7===d&&e.push([a,b],[a-1,b],[a-1,b-1],[a-1,b-2]);break;case 7:0===d&&e.push([a,b],[a,b-1],[a+1,b-1],[a+1,b-2]),1===d&&e.push([a,b],[a-1,b],[a-1,b-1],[a-2,b-1]),4===d&&e.push([a,b],[a,b-1],[a-1,b-1],[a-1,b-2]),5===d&&e.push([a,b],[a-1,b],[a,b-1],[a+1,b-1]);break;case 8:0===d&&e.push([a,b],[a-1,b],[a,b-1],[a-1,b-1]);break;case 9:0===d&&e.push([a,b],[a,b-1],[a,b-2],[a,b-3],[a-1,b-3]),1===d&&e.push([a,b],[a,b-1],[a+1,b-1],[a+2,b-1],[a+3,b-1]),2===d&&e.push([a,b],[a-1,b],[a-1,b-1],[a-1,b-2],[a-1,b-3]),3===d&&e.push([a,b],[a,b-1],[a-1,b],[a-2,b],[a-3,b]),4===d&&e.push([a,b],[a-1,b],[a,b-1],[a,b-2],[a,b-3]),5===d&&e.push([a,b],[a,b-1],[a-1,b-1],[a-2,b-1],[a-3,b-1]),6===d&&e.push([a,b],[a,b-1],[a,b-2],[a,b-3],[a+1,b-3]),7===d&&e.push([a,b],[a-1,b],[a-2,b],[a-3,b],[a-3,b-1]);break;case 10:0===d&&e.push([a,b],[a,b-1],[a,b-2],[a-1,b-1],[a-2,b-1]),1===d&&e.push([a,b],[a,b-1],[a,b-2],[a-1,b-2],[a+1,b-2]),2===d&&e.push([a,b],[a-1,b],[a-2,b],[a-2,b-1],[a-2,b+1]),3===d&&e.push([a,b],[a-1,b],[a-2,b],[a-1,b-1],[a-1,b-2]);break;case 11:0===d&&e.push([a,b],[a,b-1],[a,b-2],[a-1,b-2],[a-2,b-2]),1===d&&e.push([a,b],[a,b-1],[a,b-2],[a+1,b-2],[a+2,b-2]),2===d&&e.push([a,b],[a-1,b],[a-2,b],[a-2,b-1],[a-2,b-2]),3===d&&e.push([a,b],[a,b-1],[a,b-2],[a-1,b],[a-2,b]);break;case 12:0===d&&e.push([a,b],[a,b-1],[a,b-2],[a+1,b-2],[a+1,b-3]),1===d&&e.push([a,b],[a-1,b],[a-2,b],[a-2,b-1],[a-3,b-1]),2===d&&e.push([a,b],[a,b-1],[a+1,b-1],[a+1,b-2],[a+1,b-3]),3===d&&e.push([a,b],[a-1,b],[a-1,b-1],[a-2,b-1],[a-3,b-1]),4===d&&e.push([a,b],[a,b-1],[a-1,b-1],[a-1,b-2],[a-1,b-3]),5===d&&e.push([a,b],[a-1,b],[a-2,b],[a,b-1],[a+1,b-1]),6===d&&e.push([a,b],[a,b-1],[a,b-2],[a-1,b-2],[a-1,b-3]),7===d&&e.push([a,b],[a-1,b],[a,b-1],[a+1,b-1],[a+2,b-1]);break;case 13:0===d&&e.push([a,b],[a-1,b],[a,b-1],[a,b-2],[a+1,b-2]),1===d&&e.push([a,b],[a,b-1],[a-1,b-1],[a-2,b-1],[a-2,b-2]),4===d&&e.push([a,b],[a-1,b],[a-1,b-1],[a-1,b-2],[a-2,b-2]),5===d&&e.push([a,b],[a,b-1],[a+1,b-1],[a+2,b-1],[a+2,b-2]);break;case 14:0===d&&e.push([a,b],[a,b-1],[a,b-2],[a-1,b-1]),1===d&&e.push([a,b],[a+1,b-1],[a,b-1],[a-1,b-1]),2===d&&e.push([a,b],[a,b-1],[a,b-2],[a+1,b-1]),3===d&&e.push([a,b],[a-1,b],[a-2,b],[a-1,b-1]);break;case 15:0===d&&e.push([a,b],[a-1,b],[a-1,b-1],[a,b-1],[a+1,b-1]),1===d&&e.push([a,b],[a-1,b],[a,b-1],[a-1,b-1],[a-1,b-2]),2===d&&e.push([a,b],[a,b-1],[a-1,b],[a-1,b-1],[a-2,b]),3===d&&e.push([a,b],[a-1,b-1],[a,b-1],[a-1,b-2],[a,b-2]),4===d&&e.push([a,b],[a-1,b],[a-2,b],[a-1,b-1],[a-2,b-1]),5===d&&e.push([a,b],[a-1,b],[a-1,b-1],[a,b-1],[a,b-2]),6===d&&e.push([a,b],[a-1,b],[a,b-1],[a-1,b-1],[a-2,b-1]),7===d&&e.push([a,b],[a,b-1],[a,b-2],[a+1,b-1],[a+1,b-2]);break;case 16:0===d&&e.push([a,b],[a,b-1],[a+1,b-1],[a+1,b-2],[a+2,b-2]),1===d&&e.push([a,b],[a-1,b],[a-1,b-1],[a-2,b-1],[a-2,b-2]),2===d&&e.push([a,b],[a-1,b],[a,b-1],[a+1,b-1],[a+1,b-2]),3===d&&e.push([a,b],[a,b-1],[a-1,b-1],[a-1,b-2],[a-2,b-2]);break;case 17:0===d&&e.push([a,b],[a,b-1],[a-1,b-1],[a-2,b-1],[a-2,b]),1===d&&e.push([a,b],[a-1,b],[a-1,b-1],[a-1,b-2],[a,b-2]),2===d&&e.push([a,b],[a,b-1],[a-1,b],[a-2,b],[a-2,b-1]),3===d&&e.push([a,b],[a-1,b],[a,b-1],[a,b-2],[a-1,b-2]);break;case 18:0===d&&e.push([a,b],[a,b-1],[a+1,b-1],[a+2,b-1],[a+1,b-2]),1===d&&e.push([a,b],[a-1,b],[a-1,b-1],[a-1,b-2],[a-2,b-1]),2===d&&e.push([a,b],[a-1,b-1],[a,b-1],[a+1,b-1],[a+1,b-2]),3===d&&e.push([a,b],[a,b-1],[a,b-2],[a-1,b-2],[a+1,b-1]),4===d&&e.push([a,b],[a-1,b-1],[a,b-1],[a+1,b-1],[a-1,b-2]),5===d&&e.push([a,b],[a-1,b],[a,b-1],[a,b-2],[a+1,b-1]),6===d&&e.push([a,b],[a,b-1],[a-1,b-1],[a-2,b-1],[a-1,b-2]),7===d&&e.push([a,b],[a-1,b-1],[a,b-1],[a,b-2],[a+1,b-2]);break;case 19:0===d&&e.push([a,b],[a,b-1],[a,b-2],[a-1,b-1],[a+1,b-1]);break;case 20:0===d&&e.push([a,b],[a,b-1],[a,b-2],[a,b-3],[a-1,b-2]),1===d&&e.push([a,b],[a-1,b-1],[a,b-1],[a+1,b-1],[a+2,b-1]),2===d&&e.push([a,b],[a,b-1],[a,b-2],[a,b-3],[a+1,b-1]),3===d&&e.push([a,b],[a-1,b],[a-2,b],[a-3,b],[a-1,b-1]),4===d&&e.push([a,b],[a,b-1],[a,b-2],[a,b-3],[a-1,b-1]),5===d&&e.push([a,b],[a+1,b-1],[a,b-1],[a-1,b-1],[a-2,b-1]),6===d&&e.push([a,b],[a,b-1],[a,b-2],[a,b-3],[a+1,b-2]),7===d&&e.push([a,b],[a-1,b],[a-2,b],[a-3,b],[a-2,b-1])}return e}function D(){return E}a.getInitialBoard=b,a.getInitialFreeShapes=c,a.getInitialPlayerStatus=d,a.getPossibleMoves=e,a.traverseBoard=f,a.shuffle=g,a.getPossibleMovesWithSqaureN=h,a.isValidRotation=i,a.getPossibleRotations=j,a.createMove=k,a.isMoveOk=l,a.updateFreeShapes=m,a.canMove=n,a.updatePlayerStatus=o,a.shapeUsedUp=p;var E=0;a.updateTurnIndex=q,a.endOfMatch=r,a.getScore=s,a.inBounds=t,a.squareCornerConnected=u,a.cornerConnected=v,a.squareEdgeConnected=w,a.edgeConnected=x,a.isOccupied=y,a.placementInBound=z,a.isFirstMove=A,a.legalPlacement=B,a.getPlacement=C,a.getInternalTurnIndex=D}(gameLogic||(gameLogic={})),angular.module("myApp",["ngTouch","ui.bootstrap","gameServices"]).factory("gameLogic",function(){return{getScore:gameLogic.getScore,endOfMatch:gameLogic.endOfMatch,getInitialBoard:gameLogic.getInitialBoard,getInitialFreeShapes:gameLogic.getInitialFreeShapes,getInitialPlayerStatus:gameLogic.getInitialPlayerStatus,createMove:gameLogic.createMove,isMoveOk:gameLogic.isMoveOk,legalPlacement:gameLogic.legalPlacement,getPlacement:gameLogic.getPlacement,getPossibleMoves:gameLogic.getPossibleMoves,isOccupied:gameLogic.isOccupied,placementInBound:gameLogic.placementInBound,getPossibleMovesWithSqaureN:gameLogic.getPossibleMovesWithSqaureN,getInternalTurnIndex:gameLogic.getInternalTurnIndex}}),angular.module("myApp").controller("Ctrl",["$scope","$log","$timeout","gameLogic",function(a,b,c,d){"use strict";function e(a,b,c){document.getElementById("e2e_test_board_div_"+a+"x"+b).style.background=c}function f(b,c){return"0"===a.state.board[b][c]?"#33CCFF":"1"===a.state.board[b][c]?"#FF9900":"2"===a.state.board[b][c]?"#FF3399":"3"===a.state.board[b][c]?"#99FF33":"#F0F0F0"}function g(){var b=["#33CCFF","#FF9900","#FF3399","#99FF33"];return b[a.internalTurnIndex]}function h(a){for(var b=0;b<a.length;b++){var c=a[b][0],d=a[b][1];e(c,d,g())}}function i(b){if("board"===b)for(var c=0;c<a.preview.length;c++){var d=a.preview[c][0],g=a.preview[c][1];e(d,g,f(d,g))}var h=document.getElementById(b+"DraggingLines");h.style.display="none"}function j(a){var b=document.getElementById(a+"Area");return{width:b.clientWidth,height:b.clientHeight}}function k(b,c,e){var f=document.getElementById("gameArea"),g=document.getElementById("boardArea"),k=document.getElementById("shapeArea"),m=document.getElementById("rotateArea");if(!d.endOfMatch(a.state.playerStatus)&&a.isYourTurn){var p,q,r=c-f.offsetLeft-g.offsetLeft,s=c-f.offsetLeft-k.offsetLeft,t=c-f.offsetLeft-m.offsetLeft,u=e-f.offsetTop-g.offsetTop,v=e-f.offsetTop-k.offsetTop,w=e-f.offsetTop-m.offsetTop,x="",y=j("board"),z=j("shape"),A=j("rotate");if(r>0&&r<y.width&&u>0&&u<y.height?(p=r,q=u,x="board"):a.shape>=0&&-1===a.rotate&&t>0&&t<A.width&&w>0&&w<A.height?(p=t,q=w,x="rotate",i("board")):(-1===a.shape&&-1===a.rotate||a.shape>=0&&a.rotate>=0)&&s<z.width&&v>0&&v<z.height&&(p=s,q=v,x="shape",i("rotate")),""===x)return i("board"),i("shape"),void i("rotate");var B=l(x),C=j(x),D=Math.floor(B.colsNum*p/C.width),E=Math.floor(B.rowsNum*q/C.height);if("board"===x){if(-1===a.shape)return;if(-1===a.rotate)return;var F=d.getPlacement(E,D,a.shape,a.rotate);if(!d.placementInBound(a.state.board,F)||d.isOccupied(a.state.board,F))return void i("board");angular.equals(a.preview,F)||(i("board"),h(F),a.preview=F)}var G=document.getElementById(x+"DraggingLines"),H=document.getElementById(x+"HorizontalDraggingLine"),I=document.getElementById(x+"VerticalDraggingLine");G.style.display="inline";var J=n(E,D,x);I.setAttribute("x1",J.x),I.setAttribute("x2",J.x),H.setAttribute("y1",J.y),H.setAttribute("y2",J.y),("touchend"===b||"touchcancel"===b||"touchleave"===b||"mouseup"===b)&&(o(E,D,x),i(x))}}function l(a){return"board"===a?{rowsNum:20,colsNum:20}:"shape"===a?{rowsNum:12,colsNum:20}:"rotate"===a?{rowsNum:12,colsNum:20}:void 0}function m(a){var b=j(a),c=l(a);return{width:b.width/c.colsNum,height:b.height/c.rowsNum}}function n(a,b,c){var d=m(c);return{x:b*d.width+d.width/2,y:a*d.height+d.height/2}}function o(b,c,d){$rootScope.$apply(function(){"board"===d&&a.boardAreaCellClicked(b,c),"shape"===d&&a.shapeAreaCellClicked(b,c),"rotate"===d&&a.rotateAreaCellClicked(b,c)})}function p(b){a.state=b.stateAfterMove,a.shape=-1,a.rotate=-1,a.preview=[],void 0===a.state.board&&(a.state.board=d.getInitialBoard(),a.state.freeShapes=d.getInitialFreeShapes(),a.state.playerStatus=d.getInitialPlayerStatus()),a.isYourTurn=b.turnIndexAfterMove>=0&&b.yourPlayerIndex===b.turnIndexAfterMove,a.turnIndex=b.turnIndexAfterMove,a.internalTurnIndex=d.getInternalTurnIndex(),a.isYourTurn&&""===b.playersInfo[b.yourPlayerIndex].playerId&&(a.isYourTurn=!1,c(q,500)),console.log("turnIndex: "+a.turnIndex),console.log("internalTurnIndex"+a.internalTurnIndex),console.log(a.state.playerStatus)}function q(){var b=d.getPossibleMoves(a.state,a.internalTurnIndex);gameService.makeMove(b[Math.floor(Math.random()*b.length)])}a.setBoardAreaSquareStyle=function(a,b){var c=f(a,b);return{background:c}},dragAndDropService.addDragListener("gameArea",k),a.newlyPlaced=function(b,c){if(void 0===a.state.delta)return!1;for(var d=a.state.delta.placement,e=0;e<d.length;e++)if(d[e][0]===b&&d[e][1]===c)return!0;return!1},resizeGameAreaService.setWidthToHeight(.6),gameService.setGame({gameDeveloperEmail:"yw1840@nyu.edu",minNumberOfPlayers:2,maxNumberOfPlayers:2,isMoveOk:d.isMoveOk,updateUI:p}),a.getRotateAreaSquareColor=function(b,c){if(-1===a.getRotate(b,c))return{background:"#F0F0F0"};var d=g();return{border:"1pt solid white",background:d}},a.getRotate=function(b,c){var d=-1;return 0===a.shape&&1===b&&1===c&&(d=0),1===a.shape&&((0===b&&1===c||1===b&&1===c)&&(d=0),(1===b&&5===c||1===b&&6===c)&&(d=1)),2===a.shape&&(b>=0&&2>=b&&1===c&&(d=0),c>=5&&7>=c&&1===b&&(d=1)),3===a.shape&&(b>=0&&3>=b&&1===c&&(d=0),c>=5&&8>=c&&2===b&&(d=1)),4===a.shape&&(b>=0&&4>=b&&1===c&&(d=0),c>=5&&9>=c&&2===b&&(d=1)),5===a.shape&&((1===b&&1===c||2===b&&1===c||2===b&&2===c)&&(d=0),(1===b&&6===c||1===b&&7===c||2===b&&6===c)&&(d=1),(1===b&&11===c||1===b&&12===c||2===b&&12===c)&&(d=2),(2===b&&17===c||2===b&&18===c||1===b&&18===c)&&(d=3)),6===a.shape&&((b>=0&&2>=b&&1===c||2===b&&2===c)&&(d=0),(c>=6&&8>=c&&1===b||2===b&&6===c)&&(d=1),(b>=0&&2>=b&&12===c||0===b&&11===c)&&(d=2),(c>=16&&18>=c&&2===b||1===b&&18===c)&&(d=3),(b>=4&&6>=b&&2===c||6===b&&1===c)&&(d=4),(c>=6&&8>=c&&6===b||5===b&&6===c)&&(d=5),(b>=4&&6>=b&&11===c||4===b&&12===c)&&(d=6),(c>=16&&18>=c&&5===b||6===b&&18===c)&&(d=7)),7===a.shape&&((1===b&&2===c||1===b&&3===c||2===b&&1===c||2===b&&2===c)&&(d=0),(0===b&&6===c||1===b&&6===c||1===b&&7===c||2===b&&7===c)&&(d=1),(1===b&&11===c||1===b&&12===c||2===b&&12===c||2===b&&13===c)&&(d=4),(1===b&&17===c||2===b&&17===c||0===b&&18===c||1===b&&18===c)&&(d=5)),8===a.shape&&(0===b&&1===c||0===b&&2===c||1===b&&1===c||1===b&&2===c)&&(d=0),9===a.shape&&((c>=0&&3>=c&&3===b||2===b&&0===c)&&(d=0),(b>=0&&3>=b&&6===c||0===b&&7===c)&&(d=1),(c>=10&&13>=c&&2===b||3===b&&13===c)&&(d=2),(b>=0&&3>=b&&17===c||3===b&&16===c)&&(d=3),(c>=0&&3>=c&&8===b||7===b&&3===c)&&(d=4),(b>=5&&8>=b&&6===c||8===b&&7===c)&&(d=5),(c>=10&&13>=c&&7===b||8===b&&10===c)&&(d=6),(b>=5&&8>=b&&17===c||5===b&&16===c)&&(d=7)),10===a.shape&&((2===b&&1===c||2===b&&2===c||2===b&&3===c||0===b&&2===c||1===b&&2===c)&&(d=0),(0===b&&6===c||1===b&&6===c||2===b&&6===c||1===b&&7===c||1===b&&8===c)&&(d=1),(0===b&&11===c||0===b&&12===c||0===b&&13===c||1===b&&12===c||2===b&&12===c)&&(d=2),(1===b&&16===c||1===b&&17===c||1===b&&18===c||0===b&&18===c||2===b&&18===c)&&(d=3)),11===a.shape&&((0===b&&1===c||1===b&&1===c||2===b&&1===c||2===b&&2===c||2===b&&3===c)&&(d=0),(0===b&&6===c||0===b&&7===c||0===b&&8===c||1===b&&6===c||2===b&&6===c)&&(d=1),(0===b&&11===c||0===b&&12===c||0===b&&13===c||1===b&&13===c||2===b&&13===c)&&(d=2),(2===b&&16===c||2===b&&17===c||2===b&&18===c||0===b&&18===c||1===b&&18===c)&&(d=3)),12===a.shape&&((2===b&&c>=0&&1>=c||1===b&&c>=1&&3>=c)&&(d=0),(b>=0&&1>=b&&6===c||b>=1&&3>=b&&7===c)&&(d=1),(2===b&&c>=11&&13>=c||1===b&&c>=13&&14>=c)&&(d=2),(b>=0&&2>=b&&17===c||b>=2&&3>=b&&18===c)&&(d=3),(6===b&&c>=0&&2>=c||7===b&&c>=2&&3>=c)&&(d=4),(b>=7&&8>=b&&6===c||b>=5&&7>=b&&7===c)&&(d=5),(6===b&&c>=11&&12>=c||7===b&&c>=12&&14>=c)&&(d=6),(b>=6&&8>=b&&17===c||b>=5&&6>=b&&18===c)&&(d=7)),13===a.shape&&((1===b&&c>=1&&3>=c||0===b&&3===c||2===b&&1===c)&&(d=0),(b>=0&&2>=b&&7===c||0===b&&6===c||2===b&&8===c)&&(d=1),(1===b&&c>=11&&13>=c||0===b&&11===c||2===b&&13===c)&&(d=4),(b>=0&&2>=b&&17===c||2===b&&16===c||0===b&&18===c)&&(d=5)),14===a.shape&&((1===b&&c>=0&&2>=c||0===b&&1===c)&&(d=0),(b>=0&&2>=b&&6===c||1===b&&7===c)&&(d=1),(0===b&&c>=11&&13>=c||1===b&&12===c)&&(d=2),(b>=0&&2>=b&&18===c||1===b&&17===c)&&(d=3)),15===a.shape&&((b>=0&&1>=b&&c>=1&&2>=c||2===b&&1===c)&&(d=0),(b>=1&&2>=b&&c>=7&&8>=c||1===b&&6===c)&&(d=1),(b>=1&&2>=b&&c>=12&&13>=c||0===b&&13===c)&&(d=2),(b>=1&&2>=b&&c>=17&&18>=c||2===b&&19===c)&&(d=3),(b>=4&&5>=b&&c>=1&&2>=c||6===b&&2===c)&&(d=4),(b>=5&&6>=b&&c>=7&&8>=c||6===b&&6===c)&&(d=5),(b>=5&&6>=b&&c>=12&&13>=c||4===b&&12===c)&&(d=6),(b>=5&&6>=b&&c>=17&&18>=c||5===b&&19===c)&&(d=7)),16===a.shape&&((0===b&&2===c||0===b&&3===c||1===b&&1===c||1===b&&2===c||2===b&&1===c)&&(d=0),(0===b&&6===c||0===b&&7===c||1===b&&7===c||1===b&&8===c||2===b&&8===c)&&(d=1),(2===b&&12===c||2===b&&13===c||1===b&&13===c||1===b&&14===c||0===b&&14===c)&&(d=2),(0===b&&17==c||1===b&&17===c||1===b&&18==c||2===b&&18===c||2===b&&19===c)&&(d=3)),17===a.shape&&((b>=0&&2>=b&&1===c||0===b&&2===c||2===b&&2===c)&&(d=0),(1===b&&c>=6&&8>=c||2===b&&6===c||2===b&&8===c)&&(d=1),(b>=0&&2>=b&&13===c||0===b&&12===c||2===b&&12===c)&&(d=2),(2===b&&c>=17&&19>=c||1===b&&17===c||1===b&&19===c)&&(d=3)),18===a.shape&&((b>=0&&2>=b&&2===c||1===b&&1===c||0===b&&3===c)&&(d=0),(1===b&&c>=6&&8>=c||0===b&&7===c||2===b&&8===c)&&(d=1),(b>=0&&2>=b&&13===c||2===b&&12===c||1===b&&14===c)&&(d=2),(1===b&&c>=17&&19>=c||0===b&&17===c||2===b&&18===c)&&(d=3),(b>=4&&6>=b&&2===c||4===b&&1===c||5===b&&3===c)&&(d=4),(5===b&&c>=6&&8>=c||6===b&&7===c||4===b&&8===c)&&(d=5),(b>=4&&6>=b&&13===c||5===b&&12===c||6===b&&14===c)&&(d=6),(5===b&&c>=17&&19>=c||6===b&&17==c||4===b&&18===c)&&(d=7)),19===a.shape&&(0===b&&2===c||1===b&&2===c||2===b&&2===c||1===b&&1===c||1===b&&3===c)&&(d=0),20===a.shape&&((2===b&&c>=0&&3>=c||1===b&&1===c)&&(d=0),(b>=0&&3>=b&&6===c||1===b&&7===c)&&(d=1),(1===b&&c>=11&&14>=c||2===b&&13===c)&&(d=2),(b>=0&&3>=b&&18===c||2===b&&17===c)&&(d=3),(7===b&&c>=0&&3>=c||6===b&&2===c)&&(d=4),(b>=5&&8>=b&&6===c||7===b&&7===c)&&(d=5),(6===b&&c>=11&&14>=c||7===b&&12===c)&&(d=6),(b>=5&&8>=b&&18===c||6===b&&17===c)&&(d=7)),d},a.rotateAreaCellClicked=function(b,c){var d=a.getRotate(b,c);d>=0&&(a.rotate=d)},a.boardAreaCellClicked=function(c,e){if(b.info(["Clicked on cell:",c,e]),"?throwException"===window.location.search)throw new Error("Throwing the error because URL has '?throwException'");if(a.isYourTurn&&-1!==a.shape&&-1!==a.rotate)try{var f=d.getPlacement(c,e,a.shape,a.rotate),g=d.createMove(a.state,f,a.shape,a.internalTurnIndex);a.isYourTurn=!1,gameService.makeMove(g),a.shape=-1,a.rotate=-1}catch(h){return void b.info(["This is an illegal move:",c,e])}},a.shapeAreaCellClicked=function(c,d){var e=a.getShape(c,d);a.state.freeShapes[a.internalTurnIndex][e]&&(b.info(["Clicked on shape:",e]),a.shape=e,a.rotate=-1)},a.getShapeCellColorStyle=function(b,c){var d=a.getShape(b,c);if(d>=0&&void 0!=a.state.freeShapes[a.internalTurnIndex]&&a.state.freeShapes[a.internalTurnIndex][d]){var e=g();return{border:"1pt solid white",background:e}}return{background:"#F0F0F0"}},a.getShape=function(a,b){return 0===a&&4===b?0:0!==b||3!==a&&4!==a?2!==b||2!==a&&3!==a&&4!==a?7!==b||1!==a&&2!==a&&3!==a&&4!==a?9===b&&a>=0&&4>=a?4:3===a&&11===b||4===a&&11===b||4===a&&12===b?5:0===a&&b>=0&&2>=b||1===a&&0===b?6:1===a&&(11===b||12===b)||0===a&&(12===b||13===b)?7:0===a&&(15===b||16===b)||1===a&&(15===b||16===b)?8:0===a&&18===b||19===b&&a>=0&&3>=a?9:7===a&&(0===b||1===b)||2===b&&a>=6&&8>=a?10:0===b&&(9===a||10===a||11===a)||11===a&&(1===b||2===b)?11:10===a&&(16===b||17===b)||11===a&&(17===b||18===b||19===b)?12:9===a&&12===b||10===a&&(10===b||11===b||12===b)||11===a&&10===b?13:3===a&&5===b||4===b&&a>=2&&4>=a?14:7===a&&(18===b||19===b)||6===a&&b>=17&&19>=b?15:11===a&&(4===b||5===b)||10===a&&(5===b||6===b)||9===a&&6===b?16:3===a&&(14===b||16===b)||4===a&&b>=14&&16>=b?17:6===a&&9===b||10===b&&a>=6&&8>=a||7===a&&11===b?18:6===a&&14===b||7===a&&(13===b||14===b||15===b)||8===a&&14===b?19:7===a&&5===b||6===a&&b>=4&&7>=b?20:-1:3:2:1}}]);
//# sourceMappingURL=everything.min.js.map